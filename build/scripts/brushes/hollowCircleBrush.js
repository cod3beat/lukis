define(["require","fabric","brushes/circleBrushHelper","flight/lib/compose","mixins/with_outline_helper"],function(i){var t=i("fabric"),e=i("brushes/circleBrushHelper"),r=i("flight/lib/compose"),n=i("mixins/with_outline_helper"),o=t.util.createClass(t.CircleBrush,{addPoint:function(i){var e=new t.Point(i.x,i.y),r=t.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,n=new t.Color(this.color).setAlpha(t.util.getRandomInt(0,100)/100).toRgba();return e.radius=r,e.strokeColor=n,this.points.push(e),e},onMouseMove:function(i){var t=this.addPoint(i),e=this.canvas.contextTop;e.lineWidth=1,e.strokeStyle=t.strokeColor,e.beginPath(),e.arc(t.x,t.y,t.radius,0,2*Math.PI,!1),e.closePath(),e.stroke()},onMouseUp:function(){var i=this.canvas.renderOnAddition;this.canvas.renderOnAddition=!1;for(var e=0,r=this.points.length;r>e;e++){var n=this.points[e],o=new t.Circle({radius:n.radius,left:n.x,top:n.y,fill:null,stroke:n.strokeColor,strokeWidth:1});this.canvas.add(o)}this.canvas.clearContext(this.canvas.contextTop),this.removeShadowStyles(),this.canvas.renderOnAddition=i,this.canvas.renderAll()}}),a={create:function(i){return new o(i)},createShapeBrush:function(i,t){var r=this.create(i);r.width=t.brushWidth||10;var n=this.createOutline(r,t.shape,t),o=n.length;r.color=t.color||"#000000";for(var a=0;o>a;a++)r.addPoint(n[a]);e.drawCircles(i,{points:r.points})}};return r.mixin(a,[n]),a});